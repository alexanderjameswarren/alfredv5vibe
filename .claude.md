# Alfred Development Guidelines

## For AI Assistants (Claude Code, Claude Chat)

When working on this project, follow these rules:

---

## Color Usage (CRITICAL)

**NEVER use arbitrary color values or hardcoded colors.**

❌ FORBIDDEN:
- `bg-[#16A085]` or any `[#...]` arbitrary values
- `style={{color: '#...'}}`  
- `bg-green-600`, `bg-blue-600` (use semantic names instead)
- Hardcoded hex/rgb values anywhere

✅ ONLY USE:
- Semantic colors from `tailwind.config.js`: 
  - `bg-primary`, `bg-primary-hover`, `bg-primary-light`, `bg-primary-bg`
  - `bg-success`, `bg-success-hover`, `bg-success-light`
  - `bg-danger`, `bg-danger-hover`, `bg-danger-light`
  - `bg-warning`, `bg-warning-hover`, `bg-warning-light`
  - `text-dark`, `text-muted`
- Tailwind's default grays: `gray-50` through `gray-900`
- `white` and `black` (sparingly)

**All colors must be defined in `tailwind.config.js` first.**

---

## Architecture

- **Single component file:** `src/Alfred.jsx` (keep consolidated until 3000+ lines)
- **Database:** Supabase (schema in `supabase/migrations/`)
- **Storage adapter:** Handles camelCase ↔ snake_case conversion automatically
- **State management:** Single component state (no Redux/Context yet)

---

## Database Changes

When modifying database schema:

1. Create migration: `supabase migration new description`
2. Edit the migration file in `supabase/migrations/`
3. Push to cloud: `supabase db push`
4. Commit the migration file to git
5. Update storage adapter if adding new tables

**Never** modify schema directly in Supabase dashboard (use migrations for version control).

---

## Code Style

### Naming Conventions
- Functions: `camelCase`
- Components: `PascalCase`
- Database columns: `snake_case` (automatically converted by storage adapter)
- JavaScript objects: `camelCase`

### Tailwind Classes
- Use semantic spacing scale: `p-4`, `gap-6`, `mb-8`
- Consistent shadows: `shadow-sm`, `shadow-md`
- Transitions: `transition-all duration-200`
- Mobile-first responsive: `sm:`, `md:`, `lg:` prefixes

### Comments
- Add comments for complex business logic
- Document why, not what
- Mark TODOs with `// TODO: description`

---

## Data Model

### Key Relationships
- Items can link to Contexts
- Intentions link to Items (optional) and Contexts (optional)  
- Events link to Intentions (required)
- Executions link to Events (required)

### Status Values
- Executions: `'active'` (working on it) or `'paused'` (saved for later) or `'closed'` (completed)
- Events: `archived: true/false`
- Intents: `archived: true/false`

---

## Testing Checklist

After making changes, verify:
- [ ] All CRUD operations work (create, read, update, delete)
- [ ] Data persists after browser refresh
- [ ] Mobile responsive (test at 360px width)
- [ ] No console errors
- [ ] Supabase data matches UI state

---

## Deployment

Changes auto-deploy to Vercel on git push to main branch.

Test locally before pushing:
```bash
npm start  # Verify works at localhost:3000
git add .
git commit -m "Description"
git push
```

Check live site ~2 minutes after push: https://alfredv5vibe.vercel.app

---

## File Structure
```
alfred-v5/
├── src/
│   ├── Alfred.jsx          # Main app component
│   ├── supabaseClient.js   # Supabase config
│   ├── App.js              # Root wrapper
│   └── index.css           # Tailwind imports only
├── supabase/
│   └── migrations/         # Database schema versions
├── docs/
│   └── execution-view-spec.md  # Feature specifications
├── tailwind.config.js      # ALL colors defined here
├── PROJECT.md              # Setup instructions
└── .claud.md              # This file
```

---

## Common Patterns

### Creating a new entity
1. Add to state array
2. Save to Supabase via `storage.set()`
3. Update local state optimistically
4. Handle errors gracefully

### Updating an entity
1. Find in state array
2. Merge updates
3. Save to Supabase
4. Update state array

### Deleting an entity  
1. Call `storage.delete(key)`
2. Filter out of state array
3. Update dependent entities if needed

---

## When Stuck

1. Check `PROJECT.md` for setup details
2. Check `docs/execution-view-spec.md` for feature specs
3. Search existing code for similar patterns
4. Ask user for clarification on requirements

---

## Remember

- **Colors in tailwind.config.js only** ⚠️
- **Test after every change**
- **Commit working code frequently**
- **Keep Alfred.jsx under 3000 lines**
- **Mobile-first responsive design**